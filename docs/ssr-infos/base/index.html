<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ssr-infos/base">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<link rel="alternate" type="application/rss+xml" href="/Docusaurus-doc/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Docusaurus-doc/blog/atom.xml" title="My Site Atom Feed"><title data-rh="true">前端渲染模式 | My Site</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ericleen1.github.io/Docusaurus-doc/docs/ssr-infos/base"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="前端渲染模式 | My Site"><meta data-rh="true" name="description" content="图解 SSR 等 6 种前端渲染模式"><meta data-rh="true" property="og:description" content="图解 SSR 等 6 种前端渲染模式"><link data-rh="true" rel="icon" href="/Docusaurus-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ericleen1.github.io/Docusaurus-doc/docs/ssr-infos/base"><link data-rh="true" rel="alternate" href="https://ericleen1.github.io/Docusaurus-doc/docs/ssr-infos/base" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://ericleen1.github.io/Docusaurus-doc/docs/ssr-infos/base" hreflang="x-default"><link rel="stylesheet" href="/Docusaurus-doc/assets/css/styles.9902e41d.css">
<link rel="preload" href="/Docusaurus-doc/assets/js/runtime~main.cca93c23.js" as="script">
<link rel="preload" href="/Docusaurus-doc/assets/js/main.cf38b2bb.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Docusaurus-doc/"><div class="navbar__logo"><img src="/Docusaurus-doc/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Docusaurus-doc/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Docusaurus-doc/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/Docusaurus-doc/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Docusaurus-doc/docs/ssr-infos/base">SSR</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Docusaurus-doc/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Docusaurus-doc/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Basics」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Docusaurus-doc/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Extras」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/Docusaurus-doc/docs/category/ssr---infos">SSR - Infos</a><button aria-label="打开/收起侧边栏菜单「SSR - Infos」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Docusaurus-doc/docs/ssr-infos/base">前端渲染模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Docusaurus-doc/docs/ssr-infos/ssr">SSR</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Docusaurus-doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Docusaurus-doc/docs/category/ssr---infos"><span itemprop="name">SSR - Infos</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">前端渲染模式</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>前端渲染模式</h1><p>图解 SSR 等 6 种前端渲染模式</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="写在前面">写在前面<a class="hash-link" href="#写在前面" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="Docusaurus logo" src="/Docusaurus-doc/assets/images/1-d67aa0aec843e21819299c45b8b67b3f.jpeg" width="940" height="242" class="img_ev3q"></p><p>React、Vue 等现代化前端框架的大旗之下，CSR（Client-Side Rendering）模式深入人心：</p><blockquote><p>CSR (Client-Side Rendering) – rendering an app in a browser, generally using the DOM.</p></blockquote><p>前端部分几乎全都是由客户端动态渲染（客户端执行 JS 代码，动态创建 DOM 结构）出来的，例如：</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">html</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">title</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">My Awesome Web App</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">title</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">utf-8</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">bundle.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>客户端逻辑越重，初始化需要执行的 JS 越多，首屏性能就越慢，因而出现了<strong><code>更多的渲染模式</code></strong>探索：</p><ul><li>CSR：客户端渲染 - 在浏览器中渲染应用程序，通常使用 DOM。</li><li>SSR（Server-Side Rendering）：服务端渲染，在服务端将 Web 应用渲染成 HTML</li><li>Rehydration：二次渲染，复用服务端渲染的 HTML DOM 结构和数据，在客户端“温启动”JS 渲染</li><li>Prerendering：预渲染，在编译时运行一个客户端应用抓取其初始状态生成静态 HTML</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="术语">术语<a class="hash-link" href="#术语" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance"><strong>Performance</strong><a class="hash-link" href="#performance" title="标题的直接链接">​</a></h3><ul><li><strong>TTFB：</strong>第一个字节的时间 - 被视为单击链接和第一个内容进入之间的时间。</li><li><strong>FP：</strong> First Paint - 任何像素第一次对用户可见。</li><li><strong>FCP：</strong> First Contentful Paint - 请求的内容（文章正文等）变得可见的时间。</li><li><strong>TTI：</strong>交互时间 - 页面变为交互的时间（连接事件等）。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一csrclient-side-rendering">一、CSR(Client-Side Rendering)<a class="hash-link" href="#一csrclient-side-rendering" title="标题的直接链接">​</a></h2><p><strong>CSR（Client-side rendering）</strong>，即客户端渲染，是指用 JS 直接在浏览器里渲染页面，<strong><code>包括数据请求、视图模板、路由在内的所有逻辑都在客户端处理</code></strong>：</p><blockquote><p>Client-side rendering (CSR) means rendering pages directly in the browser using JavaScript. All logic, data fetching, templating and routing are handled on the client rather than the server.</p></blockquote><p>渲染流程如下图：</p><p><img loading="lazy" alt="CSR" src="/Docusaurus-doc/assets/images/csr-54126911fbb50f0035b8f9f6fa8b98c7.png" width="1080" height="434" class="img_ev3q"></p><p><strong>PS：</strong>其中出现的 FCP 与 TTI 是两个重要的性能指标：</p><ul><li>FCP（First Contentful Paint）：用户所请求的内容在屏幕上可见的时间点</li><li>TTI（Time To Interactive）：页面可交互的时间点</li></ul><p>主要缺陷在于随着应用程序的更新迭代，<strong><code>客户端所要执行 JS 代码量越来越多</code></strong>，前置的第三方类库/框架、polyfill 等都会在一定程度上拖慢首屏性能，在（中低端）移动设备上尤为明显</p><p>Code splitting、<a href="http://mp.weixin.qq.com/s?__biz=MzIwMTM5MTM1NA==&amp;mid=2649473171&amp;idx=1&amp;sn=651a2cca45c940ab4b774753171e4828&amp;chksm=8ef1cd06b986441052f2622863cb0b8d151d8b69fbc849231512eb7a44ef7d95c0c1aa22844d&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">lazy-load</a>等优化措施能够缓解一部分，但优化空间相对有限，无助于从根本上解决问题</p><p>此时，只有改变渲染模式才能创造更多的可能性</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二ssr">二、SSR<a class="hash-link" href="#二ssr" title="标题的直接链接">​</a></h2><p><strong>SSR（Server-Side Rendering）</strong>并不是什么新奇的概念，前后端分层之前很长的一段时间里都是以服务端渲染为主（JSP、PHP），在服务端生成完整的 HTML 页面：</p><blockquote><p>Server rendering generates the full HTML for a page on the server in response to navigation.<em>This avoids additional round-trips for data fetching and templating on the client, since it’s handled before the browser gets a response.</em></p></blockquote><p>省去了客户端二次请求数据的网络开销，以及渲染视图模板的性能负担。</p><p>与 CSR 相比，其 FCP、TTI 通常会更快：</p><p><img loading="lazy" alt="SSR" src="/Docusaurus-doc/assets/images/ssr-7e9438e226d7ae2fca2762adeaa44987.png" width="994" height="614" class="img_ev3q"></p><p>PS：另一方面，服务端的网络环境要优于客户端，内部服务器之间通信路径也更短</p><p>因为页面逻辑（包括即时数据请求）和模板渲染工作都放在服务端完成，减少了客户端的 JS 代码量，流式文档解析（streaming document parsing）等浏览器优化机制也能发挥其作用，在低端设备和弱网情况下表现更好。但<strong><code>在服务器上生成页面同样需要时间</code></strong>，会导致页面内容响应时间（TTFB, Time to First Byte）变慢</p><p>一种办法是可以通过流式 SSR、组件级缓存、模板化、HTML 缓存等技术来进一步优化</p><p>许多现代框架、库和架构使得在客户端和服务器上呈现相同的应用程序成为可能。这些技术可用于服务器渲染，但重要的是要注意，在服务器<strong><em>和</em></strong>客户端都发生渲染的架构是它们自己的解决方案类别，具有非常不同的性能特征和权衡。React 用户可以使用<a href="https://reactjs.org/docs/react-dom-server.html" target="_blank" rel="noopener noreferrer">renderToString()</a>或构建在它之上的解决方案，例如<a href="https://nextjs.org/" target="_blank" rel="noopener noreferrer">Next.js</a>进行服务器渲染。Vue 用户可以查看 Vue 的<a href="https://ssr.vuejs.org/" target="_blank" rel="noopener noreferrer">服务器渲染指南</a>或<a href="https://nuxtjs.org/" target="_blank" rel="noopener noreferrer">Nuxt</a>。Angular 具有<a href="https://angular.io/guide/universal" target="_blank" rel="noopener noreferrer">通用性</a>. 不过，大多数流行的解决方案都采用某种形式的混合形式，因此在选择工具之前请注意使用的方法。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三static-rendering">三、Static Rendering<a class="hash-link" href="#三static-rendering" title="标题的直接链接">​</a></h2><p><strong>demo</strong>:<a href="https://www.86wxw.com/0/403/index.html" target="_blank" rel="noopener noreferrer">小说网站</a></p><p>将生成 HTML 页面的工作放到编译时，而不必在请求带来时动态完成。为每个 URL 预先单独生成 HTML 文件，并进一步借助<a href="http://mp.weixin.qq.com/s?__biz=MzIwMTM5MTM1NA==&amp;mid=2649473411&amp;idx=1&amp;sn=da86e432ceb7115433d15e35dd61be97&amp;chksm=8ef1cc16b98645002c10513416fe9a984046de3de1642cc0f0a39553d47006862d8cdbaedcb1&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">CDN</a>加速访问：</p><blockquote><p>Static rendering happens at build-time and offers a fast First Paint, First Contentful Paint and Time To Interactive – assuming the amount of client-side JS is limited. Unlike Server Rendering, it also manages to achieve a consistently fast Time To First Byte, since the HTML for a page doesn’t have to be generated on the fly.</p></blockquote><p>渲染流程如下图：</p><p><img loading="lazy" alt="StaticRendering" src="/Docusaurus-doc/assets/images/StaticRendering-3e861843cf0f6d186051470b7d5a1c74.png" width="1080" height="827" class="img_ev3q"></p><p>PS：SSR 第一部分的 Server Rendering 渲染工作变成了 Streaming 传递静态 HTML 文件</p><p>静态渲染也并非完美，其关键问题在于<strong><code>“静态”</code></strong>：</p><ul><li>需要为每个 URL 单独生成一份 HTML 文件：对于无法预知所有可能的 URL，或者存在大量不同页面的网站，静态渲染就不那么容易，甚至根本不可行</li><li>只适用于偏静态内容：对于动态的、个性化的内容作用不大</li></ul><p>另外，还有个与静态渲染相似的概念，叫预渲染（Prerendering）</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四prerendering">四、Prerendering<a class="hash-link" href="#四prerendering" title="标题的直接链接">​</a></h2><p>主要区别在于，静态渲染得到的页面已经是可交互的，无需在客户端额外执行大量 JS 代码，而<strong><code>预渲染必须经客户端渲染才真正可交互</code></strong>：</p><blockquote><p>Static rendered pages are interactive without the need to execute much client-side JS, whereas prerendering improves the First Paint or First Contentful Paint of a Single Page Application that must be booted on the client in order for pages to be truly interactive.</p></blockquote><p>也就是说，禁用 JS 后，静态渲染的页面几乎不受影响，而预渲染的页面将只剩下超链接之类的基本功能</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="五rehydration">五、Rehydration<a class="hash-link" href="#五rehydration" title="标题的直接链接">​</a></h2><p>Rehydration 模式将 CSR 与 SSR 结合起来了，<strong><code>服务端渲染出基本内容后，在客户端进行二次渲染（Rehydration）</code></strong>：</p><blockquote><p>Often referred to as Universal Rendering or simply “SSR”, this approach attempts to smooth over the trade-offs between Client-Side Rendering and Server Rendering by doing both. Navigation requests like full page loads or reloads are handled by a server that renders the application to HTML, then the JavaScript and data used for rendering is embedded into the resulting document.</p></blockquote><p>例如：</p><p><img loading="lazy" alt="Rehydration" src="/Docusaurus-doc/assets/images/Rehydration-86d48f77aadfb14e40fb74cf909c5a7f.png" class="img_ev3q"></p><p>实际渲染流程如下：</p><p><img loading="lazy" alt="Rehydration" src="/Docusaurus-doc/assets/images/Rehydration2-1ab353ba769a61c1c87c0386c14f4b3f.png" class="img_ev3q"></p><p>注意<code>bundle.js</code>仍然是<em>全量的 CSR 代码</em>，这些代码执行完毕页面才真正可交互。因此，这种模式下，FP（First Paint）虽然有所提升，但 TTI（Time To Interactive）可能会变慢，因为在客户端二次渲染完成之前，页面无法响应用户输入（被 JS 代码执行阻塞了）</p><p>对于二次渲染造成交互无法响应的问题，可能的优化方向是增量渲染（例如<a href="http://mp.weixin.qq.com/s?__biz=MzIwMTM5MTM1NA==&amp;mid=2649472898&amp;idx=1&amp;sn=4981b77656603b770a39bbf8920c0c49&amp;chksm=8ef1b217b9863b013bcfb6a2da2a70a93a5323939714d22770f49da4438d69950cda6ad37961&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">React Fiber</a>），以及渐进式渲染/部分渲染</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="六trisomorphic-rendering">六、Trisomorphic Rendering<a class="hash-link" href="#六trisomorphic-rendering" title="标题的直接链接">​</a></h2><p>如果把<a href="http://mp.weixin.qq.com/s?__biz=MzIwMTM5MTM1NA==&amp;mid=400647614&amp;idx=1&amp;sn=e1ac2b90425c0a149e376dde31f2d3a9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Service Worker</a>也考虑进来的话，还有一种<em>涉及三方的渲染模式</em>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SSR + CSR + ServiceWorker rendering = Trisomorphic Rendering</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如下图：</p><p><img loading="lazy" alt="图片" src="/Docusaurus-doc/assets/images/Trisomorphic-8b434f200690710ef7fc5ea3b7c0924a.png" class="img_ev3q"></p><p>首先通过流式 SSR 渲染初始页面，接着由 Service Worker 根据路由规则，借助 SSR 渲染出目标 HTML 页面：</p><blockquote><p>It’s a technique where you can use streaming server rendering for initial/non-JS navigations, and then have your service worker take on rendering of HTML for navigations after it has been installed. This can keep cached components and templates up to date and enables SPA-style navigations for rendering new views in the same session.</p></blockquote><p>主要优势在于能够跨三方共享模板渲染和路由控制逻辑：</p><blockquote><p>This approach works best when you can share the same templating and routing code between the server, client page, and service worker.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="seo注意事项"><a href="https://web.dev/rendering-on-the-web/#seo-considerations" target="_blank" rel="noopener noreferrer">SEO注意事项</a><a class="hash-link" href="#seo注意事项" title="标题的直接链接">​</a></h2><p>团队在选择网络渲染策略时通常会考虑 SEO 的影响。通常选择服务器渲染来提供爬虫可以轻松解释的“完整外观”体验。爬虫<a href="https://web.dev/discoverable/how-search-works" target="_blank" rel="noopener noreferrer">可能会理解 JavaScript</a>，但在它们的渲染方式上通常存在一些值得关注的<a href="https://developers.google.com/search/docs/guides/rendering" target="_blank" rel="noopener noreferrer">限制。</a>客户端渲染可以工作，但通常需要额外的测试和工作。最近，如果您的架构主要由客户端 JavaScript 驱动，那么<a href="https://developers.google.com/search/docs/advanced/javascript/dynamic-rendering" target="_blank" rel="noopener noreferrer">动态渲染</a>也成为一个值得考虑的选项。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a class="hash-link" href="#总结" title="标题的直接链接">​</a></h2><p>每种渲染模式都有一定优势，也有其局限性和缺点，实际场景中需要在多种因素之下权衡。大多数情况下使用最少的 JS 来发布 HTML 以获得交互体验是完全可以的。</p><p>服务器-客户端的一个图：</p><p><img loading="lazy" alt="对比" src="/Docusaurus-doc/assets/images/end-77ec40524b2ca90f99153bf4b0091aa7.png" width="2164" height="1434" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ssr-infos/base.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/Docusaurus-doc/docs/category/ssr---infos"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">SSR - Infos</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Docusaurus-doc/docs/ssr-infos/ssr"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">SSR</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#写在前面" class="table-of-contents__link toc-highlight">写在前面</a></li><li><a href="#术语" class="table-of-contents__link toc-highlight">术语</a><ul><li><a href="#performance" class="table-of-contents__link toc-highlight"><strong>Performance</strong></a></li></ul></li><li><a href="#一csrclient-side-rendering" class="table-of-contents__link toc-highlight">一、CSR(Client-Side Rendering)</a></li><li><a href="#二ssr" class="table-of-contents__link toc-highlight">二、SSR</a></li><li><a href="#三static-rendering" class="table-of-contents__link toc-highlight">三、Static Rendering</a></li><li><a href="#四prerendering" class="table-of-contents__link toc-highlight">四、Prerendering</a></li><li><a href="#五rehydration" class="table-of-contents__link toc-highlight">五、Rehydration</a></li><li><a href="#六trisomorphic-rendering" class="table-of-contents__link toc-highlight">六、Trisomorphic Rendering</a></li><li><a href="#seo注意事项" class="table-of-contents__link toc-highlight">SEO注意事项</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Docusaurus-doc/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Docusaurus-doc/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Docusaurus-doc/assets/js/runtime~main.cca93c23.js"></script>
<script src="/Docusaurus-doc/assets/js/main.cf38b2bb.js"></script>
</body>
</html>